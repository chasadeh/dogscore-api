<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>DogScore מבית חיית השדה</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2em; direction: rtl; background: #f7f7f7; }
    input, button { padding: 10px; font-size: 1em; }
    button { margin-right: 10px; cursor: pointer; }
    .result { background: #fff; border-radius: 8px; padding: 1em; margin-top: 1em; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .grade { font-size: 2em; font-weight: bold; }
    .grade.A { color: darkgreen; }
    .grade.B { color: green; }
    .grade.C { color: orange; }
    .grade.D { color: orangered; }
    .grade.F { color: red; }
  </style>
</head>
<body>
  <h1>מערכת דירוג DogScore</h1>
  <input type="text" id="query" placeholder="הכנס שם מזון לבדיקה..." size="40">
  <button id="checkBtn">בדוק ציון</button>
  <div id="output"></div>

  <script>
    document.getElementById('checkBtn').addEventListener('click', checkScore);

    async function checkScore() {
      const query = document.getElementById('query').value.trim();
      const out = document.getElementById('output');
      if (!query) {
        alert('נא להזין שם מוצר.');
        return;
      }

      try {
        const res = await fetch('/api/dogscore', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ productName: query })
        });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();

        if (data.error) {
          out.innerHTML = `<p style="color:red;">שגיאה: ${data.error}</p>`;
          return;
        }

        out.innerHTML = `
          <div class="result">
            <div class="grade ${data.grade}">ציון: ${data.grade}</div>
            <p><strong>סיכום:</strong> ${data.summary || ''}</p>
            <p><strong>נקודות:</strong><br>${(data.points || []).map(p => `• ${p}`).join('<br>')}</p>
            <p><strong>פרטים:</strong><br>${(data.details || []).join('<br>')}</p>
          </div>`;
      } catch (err) {
        out.innerHTML = `<p style="color:red;">שגיאה ברשת: ${err.message}</p>`;
      }
    }
  </script>
</body>
</html>
